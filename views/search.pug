#InputType(style='display:none;')
  input(name='Search' type='text' placeholder='Disabled' disabled require)
form#lignecraie(method='post' autocomplete="off")
  label(for="SearchInput") Search
  span#SearchInput
    if ParamsPost.In == 'Menus'
      -By=['Recettes','Date']
    else if ParamsPost.In == 'Recettes'
      -By=['Nom','Ingredients']
    else 
      -By=['select']
    case ParamsPost.By
      when 'Nom': input(name='Search' type='text' placeholder='ex: Ma recette' require)
      when 'Ingredients': input(name='Search' type='text' placeholder='ex: Ingredient 1, Ingredient 2' require)
      when 'Recettes': input(name='Search' type='text' placeholder='ex: Recette 1, Recette 2' require)
      when 'Date'
        newline: input(input name='Search' type='number' require Placeholder='Day' min=1 max=31 style='width:10%;')  
        newline: input(name='Search2' value='2010-01'  type='month' style='padding:1px; text-align: left; width: 29%;')
      default: input(name='Search' type='text' placeholder='Disabled' disabled require)
  label(for="InSelect") in
  +newSelect(['select','Menus','Recettes'], ParamsPost.In)(id="InSelect" name="In" require)
  label(for="BySelect")  by 
  +newSelect(By, ParamsPost.By)(id="BySelect" name="By" require)
  button: img(src="../images/ico-checkmark.png", alt="")

.liste.scroll
  if ParamsPost.Search
    -found=0;
    ul.columns2
      each key in eval(ParamsPost.In)
        -match = false
        if ParamsPost.By == 'Date'
          -mydate=ParamsPost.Search2.split('-')
          -search=mydate[1]+'-'+ParamsPost.Search+'-'+mydate[0]
          if key.Date.includes(search)
            -match=true
        else if ParamsPost.By == 'Ingredients'
          -myIngredients = ParamsPost.Search.split(',')
          -count = 0
          each ingredient in myIngredients
            each val in key.Ingredients
              if val[2]== ingredient
                -console.log(val[2])
                -count+=1
          -console.log(myIngredients.length, count)
          if myIngredients.length == count
            -console.log('if',myIngredients.length, count)
            -match=true
        else if ParamsPost.By == 'Recettes'
          -search = ParamsPost.Search.split(',')
          -function includeArray(array1, array2){count=0; for(i=0; i<array2.length; i++){if(array1.toString().includes( array2[i].charAt(0).toUpperCase()+array2[i].slice(1).toLowerCase() )) count++;} if(array2.length==count) return true; else return false }
          if includeArray(key.Matin, search) || includeArray(key.Midi, search) || includeArray(key.Soir, search)
            -match=true
        else if ParamsPost.By == 'select'
          -alert('invalid request')
        else
          if eval('key.'+ParamsPost.By).toString().includes(ParamsPost.Search.charAt(0).toUpperCase()+ParamsPost.Search.slice(1).toLowerCase())
            -match=true
        if match
          -found++
          if ParamsPost.In == 'Menus'
            li: a.Menu(href="/?Menus="+new Date(key.Date[4]).toLocaleDateString())=new Date(key.Date[4]).toDateString()
          else
            li: a.Recette(href="/?Recettes="+key.Nom)=key.Nom
    if found==0
      h3(style="text-align: center") Aucun resultat
script.
  let In, By;
  const Search = document.getElementById("SearchInput");
  const baseInput = document.getElementById("InputType").children[0].cloneNode(true);
  In = document.getElementById('InSelect').onchange = function(){
    if(Search.children.length>1) Search.innerHTML="", Search.appendChild(baseInput);
    if (this.value == 'Select'){
      Search.children[0].value = "";
      Search.children[0].setAttributee("disabled", "");
      Search.children[0].attributes["type"].value = "text"
      for(i=By.length-1; i>=0; i-=1){By.remove(i)}
    }
    else if (this.value == 'Menus'){
      for(i=By.length-1; i>=0; i-=1){By.remove(i)}
      let myOptions=['Recettes', 'Date']
      for(i=1; i<=myOptions.length; i++){
        opt=document.createElement("option");
        opt.value = myOptions[i-1];
        opt.text = myOptions[i-1];
        By.add(opt, i)
      }
      Search.children[0].attributes["type"].value = "text",
      Search.children[0].attributes["Placeholder"].value = "ex: Recette 1, Recette 2",
      Search.children[0].removeAttribute("disabled");
    }
    else if (this.value == 'Recettes'){
      for(i=By.length-1; i>=0; i-=1){By.remove(i)}
      let myOptions=['Nom', 'Ingredients']
      for(i=1; i<=myOptions.length; i++){
        let opt=document.createElement("option");
        opt.value = myOptions[i-1];
        opt.text = myOptions[i-1];
        By.add(opt,i)
      }
      Search.children[0].attributes["type"].value = "text",
      Search.children[0].attributes["Placeholder"].value = "ex: Ma recette",
      Search.children[0].removeAttribute("disabled");
    }
    else {
      for(i=By.length-1; i>=0; i-=1){By.remove(i)}
      let myOptions=['Select']
      for(i=1; i<=myOptions.length; i++){
        opt=document.createElement("option");
        opt.value = myOptions[i-1];
        opt.text = myOptions[i-1];
        By.add(opt, i)
      }
      Search.children[0].attributes["type"].value = "text";
      Search.children[0].value = "";
      Search.children[0].setAttribute("disabled", "");
      Search.children[0].attributes["Placeholder"].value = "Disabled";
    }
  }
  By = document.getElementById("BySelect")
  By.onchange = function(){
    if (this.value == 'Date') {
      Search.innerHTML="<input name='Search' type='number' require Placeholder='Day' min=1 max=31 style='width:10%;'><input name='Search2' value='2010-01'  type='month' style='padding:1px; text-align: left; width: 29%;'>";
      Search.children[1].onchange = function(){ if(this.value=="") this.value='2010-01'; console.log(this.value);}
    }
    else if (this.value == 'Recettes') {
      Search.innerHTML="";
      Search.appendChild(baseInput);
      Search.children[0].attributes["type"].value = "text";
      Search.children[0].value = "";
      Search.children[0].attributes["Placeholder"].value = "ex: Recette 1, Recette 2";
      Search.children[0].removeAttribute("disabled");
    }
    else if (this.value == 'Ingredients'){
      Search.children[0].attributes["type"].value = "text";
      Search.children[0].attributes["Placeholder"].value = "ex: Ingredient 1, Ingredient 2";
      Search.children[0].removeAttribute("disabled");
    }
    else if (this.value == 'Nom'){
      Search.children[0].attributes["type"].value = "text";
      Search.children[0].attributes["Placeholder"].value = "ex: Ma recette";
      Search.children[0].removeAttribute("disabled");
    }
    else {
      Search.children[0].value = "Unknown request";
      Search.children[0].setAttribute("disabled", "")
    }
  }